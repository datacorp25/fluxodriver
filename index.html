<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FLUXODRIVER - Controle Financeiro</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-sans">
  <div id="loginPage" class="container mx-auto p-4 max-w-md flex items-center justify-center h-screen">
    <div class="bg-white p-6 rounded-lg shadow-sm w-full">
      <h1 class="text-2xl font-bold text-center text-gray-800 mb-4">FLUXODRIVER</h1>
      <div class="mb-4">
        <label class="block text-sm text-gray-600">Usuário</label>
        <input type="text" id="username" class="mt-1 p-2 w-full border rounded" placeholder="Usuário">
      </div>
      <div class="mb-4">
        <label class="block text-sm text-gray-600">Senha</label>
        <input type="password" id="password" class="mt-1 p-2 w-full border rounded" placeholder="Senha">
      </div>
      <button onclick="login()" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Entrar</button>
      <button onclick="showRegister()" class="mt-2 w-full bg-gray-300 text-gray-800 py-2 rounded hover:bg-gray-400">Cadastrar</button>
      <p id="loginError" class="text-red-500 text-sm text-center mt-2 hidden">Usuário ou senha inválidos.</p>
    </div>
  </div>

  <div id="registerPage" class="container mx-auto p-4 max-w-md flex items-center justify-center h-screen hidden">
    <div class="bg-white p-6 rounded-lg shadow-sm w-full">
      <h1 class="text-2xl font-bold text-center text-gray-800 mb-4">Cadastro</h1>
      <div class="mb-4">
        <label class="block text-sm text-gray-600">Usuário</label>
        <input type="text" id="newUsername" class="mt-1 p-2 w-full border rounded" placeholder="Novo usuário">
      </div>
      <div class="mb-4">
        <label class="block text-sm text-gray-600">Senha</label>
        <input type="password" id="newPassword" class="mt-1 p-2 w-full border rounded" placeholder="Nova senha">
      </div>
      <button onclick="register()" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Cadastrar</button>
      <button onclick="showLogin()" class="mt-2 w-full bg-gray-300 text-gray-800 py-2 rounded hover:bg-gray-400">Voltar ao Login</button>
      <p id="registerError" class="text-red-500 text-sm text-center mt-2 hidden">Usuário já existe ou inválido.</p>
    </div>
  </div>

  <div id="mainPage" class="hidden container mx-auto p-4 text-center">
    <h1 class="text-3xl font-bold mb-4 text-gray-800">Bem-vindo ao FLUXODRIVER</h1>
    <p class="text-gray-600">Aproveite o controle financeiro do seu dia de motorista!</p>
    <button onclick="logout()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">Sair</button>
  </div>

  <div id="blockedPage" class="hidden container mx-auto p-4 max-w-md flex items-center justify-center h-screen">
    <div class="bg-white p-6 rounded-lg shadow-md w-full text-center">
      <h2 class="text-xl font-bold text-red-600 mb-4">⏳ Período de Teste Expirado</h2>
      <p class="text-gray-700 mb-4">Seu acesso gratuito de 24 horas terminou.</p>
      <p class="text-gray-700 mb-4">Para continuar usando o FLUXODRIVER, faça o pagamento único de <strong>R$19,90</strong>.</p>
      <a href="https://www.mercadopago.com.br/subscriptions/checkout?preapproval_plan_id=2c938084970fb5df019732118be90d5b" name="MP-payButton" class='blue-button'>Liberar Acesso Vitalício</a>
    </div>
  </div>

  <style>
  .blue-button {
    background-color: #3483FA;
    color: white;
    padding: 10px 24px;
    text-decoration: none;
    border-radius: 5px;
    display: inline-block;
    font-size: 16px;
    transition: background-color 0.3s;
    font-family: Arial, sans-serif;
  }
  .blue-button:hover {
    background-color: #2a68c8;
  }
  </style>
  <script type="text/javascript">
  (function() {
    function $MPC_load() {
      if (window.$MPC_loaded !== true) {
        var s = document.createElement("script");
        s.type = "text/javascript";
        s.async = true;
        s.src = document.location.protocol + "//secure.mlstatic.com/mptools/render.js";
        var x = document.getElementsByTagName('script')[0];
        x.parentNode.insertBefore(s, x);
        window.$MPC_loaded = true;
      }
    }
    window.$MPC_loaded !== true ? (window.attachEvent ? window.attachEvent('onload', $MPC_load) : window.addEventListener('load', $MPC_load, false)) : null;
  })();

  function showRegister() {
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('registerPage').classList.remove('hidden');
  }
  function showLogin() {
    document.getElementById('registerPage').classList.add('hidden');
    document.getElementById('loginPage').classList.remove('hidden');
  }
  function register() {
    const username = document.getElementById('newUsername').value;
    const password = document.getElementById('newPassword').value;
    if (!username || !password) {
      document.getElementById('registerError').classList.remove('hidden');
      return;
    }
    localStorage.setItem('user', JSON.stringify({ username, password, startTime: new Date().toISOString(), paid: false }));
    localStorage.setItem('isAuthenticated', 'true');
    document.getElementById('registerPage').classList.add('hidden');
    document.getElementById('mainPage').classList.remove('hidden');
    checkAccessTime();
  }
  function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const user = JSON.parse(localStorage.getItem('user'));
    if (user && user.username === username && user.password === password) {
      localStorage.setItem('isAuthenticated', 'true');
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('mainPage').classList.remove('hidden');
      checkAccessTime();
    } else {
      document.getElementById('loginError').classList.remove('hidden');
    }
  }
  function logout() {
    localStorage.setItem('isAuthenticated', 'false');
    document.getElementById('mainPage').classList.add('hidden');
    document.getElementById('loginPage').classList.remove('hidden');
  }
  function checkAccessTime() {
    const auth = localStorage.getItem('isAuthenticated');
    const user = JSON.parse(localStorage.getItem('user'));
    const startTime = user?.startTime;
    if (auth === 'true' && startTime) {
      const now = new Date().getTime();
      const registeredAt = new Date(startTime).getTime();
      const hoursPassed = (now - registeredAt) / (1000 * 60 * 60);
      if (hoursPassed >= 24 && !user?.paid) {
        document.getElementById('mainPage').classList.add('hidden');
        document.getElementById('blockedPage').classList.remove('hidden');
      }
    }
  }
  // Inicial
  if (localStorage.getItem('isAuthenticated') === 'true') {
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('mainPage').classList.remove('hidden');
    checkAccessTime();
  }
  </script>
</body>
</html>
